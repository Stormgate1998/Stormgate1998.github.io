<!DOCTYPE html>
<style>
    /* Dropdown Button */
    .dropbtn {
        background-color: #3498DB;
        color: white;
        padding: 16px;
        font-size: 16px;
        border: none;
        cursor: pointer;
    }

        /* Dropdown button on hover & focus */
        .dropbtn:hover, .dropbtn:focus {
            background-color: #2980B9;
        }

    /* The container <div> - needed to position the dropdown content */
    .dropdown {
        position: relative;
        display: inline-block;
    }

    /* Dropdown Content (Hidden by Default) */
    .dropdown-content {
        display: none;
        position: absolute;
        background-color: #f1f1f1;
        min-width: 160px;
        box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
        z-index: 1;
    }

        /* Links inside the dropdown */
        .dropdown-content a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
        }

            /* Change color of dropdown links on hover */
            .dropdown-content a:hover {
                background-color: #ddd
            }

    /* Show the dropdown menu (use JS to add this class to the .dropdown-content container when the user clicks on the dropdown button) */
    .show {
        display: block;
    }
    /*.topnav{
        overflow: hidden;
        position: -webkit-sticky;
        position: sticky;
        top: 0;
        width: 100%;
        padding: 0px;
        margin: 0px;
        display: flex;
        align-items: center;
    }

    .topnav p{
        float: left;
        color: aqua;
        padding: 14px 16px;
        text-decoration: none;
        font-size: 16px;
        background-color: navy;
    }*/ 

</style>
<script>
    function menubar(url) {
        wipePage(document.getElementById('main')); 
        goFetch(url);
    }
    /*
     * To make it work:
     * get names of all elements
     * get values of all elements
     * FIGURE OUT IF IT'S AN OBJECT
     * IF SO, BREAK IT IN PIECES
     * display all as elements
     * 
     * 
     * 
     * 
     * 
     */

    /* When the user clicks on the button,
toggle between hiding and showing the dropdown content */
    function myFunction() {
        document.getElementById("myDropdown").classList.toggle("show");
    }

    // Close the dropdown menu if the user clicks outside of it
    window.onclick = function (event) {
        if (!event.target.matches('.dropbtn')) {
            var dropdowns = document.getElementsByClassName("dropdown-content");
            var i;
            for (i = 0; i < dropdowns.length; i++) {
                var openDropdown = dropdowns[i];
                if (openDropdown.classList.contains('show')) {
                    openDropdown.classList.remove('show');
                }
            }
        }
    }

    window.addEventListener("load", function () {
       // const myElement = document.querySelector("body");
       // goFetch("/api/monsters/mimic"); 

    });

    //Takes an object, presents a list of all items
    function getList(sheet, addition = "") {
        const myElement = document.getElementById("main");
        //wipePage(myElement);
        var names = Object.values(sheet);
        var properties = Object.keys(sheet);
        let index = 0;
        names.forEach(element => {
            if ((typeof element) == "object") {
                //check API to view discrepencies
                let thing = document.createElement("h3");
                if (properties[index] != 0) {
                thing.innerText = properties[index];
            }
                myElement.appendChild(thing);
                getList(element/*, (addition + "       ")*/);
            } else {
                let item;
                let item2;
                element = String(element);
                if (element.includes("/")) {
                    item = document.createElement("p");
                    item2 = document.createElement("a");
                    item2.innerText = "To learn more, click here";
                    item2.addEventListener("click", (event) => {
                        wipePage(document.getElementById("main"));
                        console.log(element);
                        goFetch(element);
                    }
                        
                    );
                    item.appendChild(item2);
                } else {
                    item = document.createElement("p");
                    item.innerText = addition + properties[index] + ': ' + element;
                }
                    myElement.appendChild(item);
                    
                index++;
            }
        })

    }
    //takes a piece of url, fetches list. If an item is an object, loop. If value is empty, print N/A
    function goFetch(url) {
        let source = "https://www.dnd5eapi.co" + url;

        fetch(source)
            .then((result) => result.json())
            .then((sheet) => {
                getList(sheet);
            });
                }
    //
    //given an element, systematically removes all children from it
    function wipePage(subject) {
        while (subject.firstChild) {
            subject.removeChild(subject.lastChild);
        }
    }
    //takes any string and checks for appropriate uppercase. Removes _ as well
    function modInput(stringIn) {

    }

</script>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dnd final project</title>
</head>
<body>
    <div class="topnav">
        <div class="dropdown">
            <button onclick="myFunction()" class="dropbtn">Character Information</button>
            <div id="myDropdown" class="dropdown-content character">
                <a onclick="menubar('/api/classes')">Classes</a>
                <a onclick="menubar('/api/feats')">Feats</a>
                <a onclick="menubar('/api/ability-scores')">Ability Scores</a>
                <a onclick="menubar('/api/alignments')">Alignments</a>
            </div>
        </div>
        <div class="dropdown">
            <button onclick="myFunction()" class="dropbtn">Combat</button>
            <div id="myDropdown" class="dropdown-content combat">
                <a onclick="menubar('/api/damage-types')">Damage Types</a>
            </div>
        </div>
        <div class="dropdown">
            <button onclick="myFunction()" class="dropbtn">Magic</button>
            <div id="myDropdown" class="dropdown-content magic">
                <a onclick="menubar('/api/damage-types')">Damage Types</a>
            </div>
        </div>
        <div class="dropdown">
            <button onclick="myFunction()" class="dropbtn">General Information</button>
            <div id="myDropdown" class="dropdown-content general">
                <a onclick="menubar('/api/damage-types')">Damage Types</a>
            </div>
        </div>

        <p></p>
        <p><a onclick="menubar('/api/backgrounds')">Backgrounds</a></p>
        <p></p>
        <p><a onclick="menubar('/api/conditions')">Conditions</a></p>
        <p><a onclick="menubar('/api/equipment')">Equipment</a></p>
        <p><a onclick="menubar('/api/equipment-categories')">Equipment Categories</a></p>
        <p><a onclick="menubar('/api/features')">Features</a></p>
        <p><a onclick="menubar('/api/languages')">Languages</a></p>
        <p><a onclick="menubar('/api/magic-items')">Magic Items</a></p>
        <p><a onclick="menubar('/api/magic-schools')">Magic Schools</a></p>
        <p><a onclick="menubar('/api/monsters')">Monsters</a></p>
        <p><a onclick="menubar('/api/proficiencies')">Proficiencies</a></p>
        <p><a onclick="menubar('/api/races')">Races</a></p>
        <p><a onclick="menubar('/api/rule-sections')">Rule Sections</a></p>
        <p><a onclick="menubar('/api/rules')">Rules</a></p>
        <p><a onclick="menubar('/api/skills')">Skills</a></p>
        <p><a onclick="menubar('/api/spells')">Spells</a></p>
        <p><a onclick="menubar('/api/subclasses')">Subclasses</a></p>
        <p><a onclick="menubar('/api/subraces')">Subraces</a></p>
        <p><a onclick="menubar('/api/traits')">Traits</a></p>
        <p><a onclick="menubar('/api/weapon-properties')">Weapon Properties</a></p>
    </div>
    <div id="main">
        <p> Click anywhere to start navigating</p>
    </div>
</body>
<!--
Rewrite menu into lists
    one list for main display
    each one may or may not have relevant sublists 
    use tutorial for formatting

-->
</html>
